# -*- coding: utf-8 -*-
import os

def combine(dirpath,targetpath):
    files= os.listdir(dirpath) 
    s = []
    with open(targetpath,"a",encoding='ISO-8859-1') as tf:
        tf.write("#\tCVE ID\tCWE ID\t# of Exploits\tVulnerability Type(s)\tPublish Date\tUpdate Date\tScore\tGained Access Level\tAccess\tComplexity\tAuthentication\tConf.\tInteg.\tAvail.\n")
        for file in files: 
            print(file)
            if not os.path.isdir(file): 
                f = open(dirpath+"/"+file,"r",encoding='ISO-8859-1'); 
                tf.write(f.read().replace("#\tCVE ID\tCWE ID\t# of Exploits\tVulnerability Type(s)\tPublish Date\tUpdate Date\tScore\tGained Access Level\tAccess\tComplexity\tAuthentication\tConf.\tInteg.\tAvail.\n",""))
                print(f.read())



if __name__=='__main__':
    combine("./cve_data","./cve_data.log")